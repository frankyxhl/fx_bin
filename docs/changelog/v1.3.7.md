# Version 1.3.7 - Test Infrastructure & CLI Enhancement Release

Released: 2025-09-06

## Overview

This release resolves critical test infrastructure issues and significantly enhances the CLI user experience with comprehensive real-world examples directly in command help.

## Critical Fixes

### Test Infrastructure Fix
- **Fixed 26 failing tests** in test_pd_functional_complete.py
- Root cause: Working directory not properly restored after tests
- Solution: Added try/finally blocks to ensure cwd restoration
- Result: All 334 tests now pass (up from 308/334)

### Makefile Corrections
- Fixed test paths to use correct `tests/unit/` prefix
- Removed problematic `--forked` parameter causing test failures
- Changed main 'test' target to run stable test-core
- Added test-forked as separate command for process isolation

## Enhancements

### CLI Help Documentation
- Added comprehensive real-world examples to `fx ff` and `fx filter` commands
- Organized examples into categories: Basic, Real-World Use Cases, Advanced
- Used Click's `\b` markers for proper multi-line help formatting
- Users no longer need to open README.md to see usage examples

#### New Help Examples
```bash
# Finding files
fx ff TODO --exclude .git         # Find TODO comments
fx ff .bak                        # Find backup files
fx ff .log --exclude archive      # Find log files

# Filtering files
fx filter "jpg,png,gif"          # Find all images
fx filter py --sort-by mtime     # Recent Python changes
fx filter csv ~/data --format detailed  # Analyze data files
```

### README.md Improvements
- Removed outdated v1.2.0 announcement section
- Integrated content seamlessly into main documentation
- Enhanced fx ff section with extensive practical examples
- Better organization and flow

### Poetry Compatibility
- Resolved Poetry 2.x shell command issue
- Installed poetry-plugin-shell for virtual environment activation
- Both `poetry shell` and `poetry run` workflows now supported

## Technical Details

### Test Results
- Total Tests: 334 (all passing)
- Fixed Tests: 26
- Test Categories: unit, integration, functional, security, performance
- Coverage: Maintained comprehensive test coverage

### Code Quality
- All code passes flake8 linting
- Proper error handling maintained
- No breaking changes to existing functionality
- Backward compatibility preserved

## Migration Notes

### For Users
- Update to latest version: `pipx upgrade fx-bin`
- Explore enhanced help: `fx ff --help` or `fx filter --help`
- No changes to existing command behavior

### For Developers
- Ensure Poetry 2.x users install poetry-plugin-shell
- Use make test for stable testing, make test-all for comprehensive
- Review updated Makefile for new test targets

## Version History
- v1.3.5: Test reorganization and replace command fix
- v1.3.6: Added fx root command for Git project navigation
- **v1.3.7**: Test infrastructure fix and CLI enhancements (this release)

## Contributors
- Frank Xu <frank@frankxu.me>
- Claude (AI Assistant)

## Acknowledgments
Thanks to users who reported issues with test failures and requested better CLI documentation.